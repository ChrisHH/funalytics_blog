{
  "hash": "b4cf6fc03695538b8126d054925f78b7",
  "result": {
    "markdown": "---\ntitle: \"Maximizing Loyalty Points\"\nauthor: Christian Jaehnert\ndate: '2023-12-08'\ndraft: false\nformat: html\nslug: \ncategories:\n  - R\n  - ggplot\n  - tidyverse\n  - bargain\n  - saving money\n  - loyalty points\ntags:\n  - R\n  - ggplot\n  - groceries\n  \nsummary: \"Analyzing the best option to maximize loyalty points.\"\n---\n\n\n\n\n## Situation at Checkout\n\nImagine yourself at the checkout counter of a supermarket with a long line of unpatient customers behind you. The register shows your total as â‚¬31.28.\n\n![Source: DALLâ€¢E](images/DALLÂ·E%202023-12-08%2023.25.03%20-%20A%20realistic%20depiction%20of%20a%20supermarket%20checkout%20scene.%20Include%20a%20cashier,%20appearing%20professional%20and%20attentive,%20and%20a%20central%20human%20customer%20at%20the%20co.png){fig-align=\"center\"}\n\nIn this situation, which coupon of the following would you choose in order to maximize your loyalty points with the supermarket (normally, you get one point for every cent)?\n\n-   Triple points for a purchase of 15 Euros or more\n\n-   5,000 extra points for a purchase of 20 Euros or more\n\n-   Quintuple points for a purchase of 25 Euros or more\n\n-   10,000 extra points for a purchase of 30 Euros or more\n\nWould you be tempted to select the coupon offering 10,000 extra points, simply because the number of extra points is impressively large and you've met the required threshold? Alternatively, is the quintuple points option a smarter choice? Quick calculations could resolve this dilemma, but remember, a queue of customers is already eyeing you impatiently from behind. Their expectant gazes add pressure to your decision-making process.\n\nOh yes, these coupons are actually available at a supermarket right now. I didn't make that up. ðŸ˜‰\\\nBut I experienced this situation firsthand.\n\nToday, we'll delve into a graphical solution of the question and, as an added benefit, examine a calculated decision tree designed to guide you in selecting the most suitable coupon for this particular scenario. Lets jump into the quick and practical analysis!\n\n## Identifying the Best Coupon\n\nFirst, let's create a dataframe populated with values ranging from â‚¬0 to â‚¬100, in increments of â‚¬0.01. As mentioned already, the number of loyalty points typically awarded corresponds to the payment amount in cents. Then, I will define the four coupons as variables by applying the math of the mechanic. At the end, I determine the best coupon for each purchase value and store it in another variable.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-2_71b9d322944911364be373e27de443ef'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Click here to unhide/hide the code.\"}\nwert <- tibble(purchase_value = seq(0.01, 100,0.01))\nwert <- wert %>% \n  mutate(points = purchase_value * 100) %>% \n  mutate(points_5000_from_20 = if_else(purchase_value >=20, points + 5000, points),\n         points_10000_from_30 = if_else(purchase_value >=30, points + 10000, points),\n         points_5x_from_25 = if_else(purchase_value >= 25, 5*points, points),\n         points_3x_from_15 = if_else(purchase_value >=15, 3*points, points)) %>% \n  mutate(best_value = pmax(points_5000_from_20, points_10000_from_30, points_5x_from_25, points_3x_from_15))\n```\n:::\n\n\nLets have a glimpse on the data frame.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-3_908d6a7e37156bc296ec810f87763b8e'}\n::: {.cell-output .cell-output-stdout}\n```\nRows: 10,000\nColumns: 7\n$ purchase_value       <dbl> 0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0â€¦\n$ points               <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15â€¦\n$ points_5000_from_20  <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15â€¦\n$ points_10000_from_30 <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15â€¦\n$ points_5x_from_25    <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15â€¦\n$ points_3x_from_15    <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15â€¦\n$ best_value           <dbl> 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15â€¦\n```\n:::\n:::\n\n::: {.cell hash='index_cache/html/unnamed-chunk-4_ec80ca1eece8a8ca6dbb6245ef579210'}\n\n:::\n\n\nThat's all we need. I've now plotted the loyalty points against purchase value to visually illustrate how each coupon performs. Let's take a graphical look at the effectiveness of each offer!\n\n::: panel-tabset\n## Solution\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-5_bb4b66138532337497fb22ae710a8350'}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=1260}\n:::\n:::\n\n\n## Zoom In\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-6_c74512130cd4ff9acac2b8c4a7fbdb67'}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=1260}\n:::\n:::\n\n:::\n\nIn the plot, the dashed line represents loyalty points earned per purchase value without using a coupon.\n\nNow, let's delve into the coupon details -- it's quite intriguing!\n\n**Surprise: The coupon offering '10,000 extra points for purchases over â‚¬30' (indicated by the red line) is not advantageous for any purchase value.** ðŸ’¡ Hence, one might consider discarding this coupon right away, especially if new coupon booklets are regularly available.\n\nThe coupons providing 'Triple points for a purchase of 15 Euros or more' (blue line) and '5,000 extra points for purchases over â‚¬20' (green line) benefits customers only within a very narrow spending rangeÂ of â‚¬5. Let's take a brief look at the intersection around â‚¬25, where both lines intersect. Is it irrelevant which coupon one uses there? Not at all :-) The zoom shows that. Also, just before the next threshold, the coupon '5,000 extra points for purchases over â‚¬20' is preferable.\n\n**From â‚¬25 on the coupon 'Quintuple points for a purchase of 25 Euros or more' is the best option!**\n\n## Decision Tree\n\nThat's of course all too complicated to remember. Therefore, as a bonus, we now turn to the decision tree.\n\n\n::: {.cell hash='index_cache/html/unnamed-chunk-7_0862e0a1012f9d99c0e70741628adebb'}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Click here to unhide/hide the code.\"}\nlibrary(rpart)\nlibrary(rpart.plot)\n\n\ntree <- rpart(best_option ~ purchase_value, \n              data = wert , \n              method = \"class\")\n\n\nrpart.plot(tree, fallen.leaves = TRUE, under = TRUE, type = 5, legend.y = NA)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=1260}\n:::\n:::\n\n\nHave fun cutting the decision tree out and tucking them into your wallet ðŸ˜ƒ\n\nUntil next time!\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}